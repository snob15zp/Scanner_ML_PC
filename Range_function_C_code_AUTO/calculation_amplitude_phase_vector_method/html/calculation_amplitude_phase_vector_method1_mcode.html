<!-- saved from url=(0014)about:internet -->
<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">a</span>, <span class="var type1" id="S3T1U4">p</span>, <span class="var type1" id="S4T2U5">RS</span>, <span class="var type1" id="S5T3U6">FftR</span> ] = calculation_amplitude_phase_vector_method( <span class="var type1" id="S6T1U9">Tm</span>, <span class="var type1" id="S7T1U10">Fd</span>, <span class="var type1" id="S8T2U11">Signal</span>, <span class="var type1" id="S9T1U12">FftL</span>, <span class="var type1" id="S10T4U13">FftS</span>, <span class="var type1" id="S11T2U14">T</span>, <span class="var type1" id="S12T1U15">f</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%UNTITLED15 Summary of this function goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">%   Detailed explanation goes here</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo " id="T1:U12"><span class="var type1" id="S13T1U18">cs</span>=<span class="mxinfo " id="T1:U14">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T1:U15"><span class="var type1" id="S14T1U22">cc</span>=<span class="mxinfo " id="T1:U17">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T1:U18"><span class="var type1" id="S15T1U26">ss</span>=<span class="mxinfo " id="T1:U20">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T1:U21"><span class="var type1" id="S16T1U30">yc</span>=<span class="mxinfo " id="T1:U23">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T1:U24"><span class="var type1" id="S17T1U34">ys</span>=<span class="mxinfo " id="T1:U26">0</span></span>;  <span class="comment">% initial assignments to amounts</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S18T1U38">i</span>=<span class="mxinfo " id="T1:U28">0</span>:<span class="mxinfo " id="T1:U29"><span class="var type1" id="S7T1U42">Fd</span>*<span class="var type1" id="S6T1U43">Tm</span></span>                   <span class="comment">% number of time array indexes</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line">    <span class="mxinfo " id="T1:U32"><span class="var type1" id="S13T1U46">cs</span>=<span class="mxinfo " id="T1:U34"><span class="var type1" id="S13T1U48">cs</span>+<span class="mxinfo " id="T1:U36"><span class="mxinfo " id="T1:U37">sind(<span class="mxinfo " id="T1:U38"><span class="mxinfo " id="T1:U39"><span class="mxinfo " id="T1:U40"><span class="var type1" id="S12T1U55">f</span>*<span class="mxinfo " id="T1:U42">720</span></span>*<span class="var type1" id="S18T1U57">i</span></span>/<span class="var type1" id="S7T1U58">Fd</span></span>)</span>/<span class="mxinfo " id="T1:U45">2</span></span></span></span>;   <span class="comment">% simplification cos(x)*sin(x)=sin(2*x)/2</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="mxinfo " id="T1:U46"><span class="var type1" id="S14T1U62">cc</span>=<span class="mxinfo " id="T1:U48"><span class="var type1" id="S14T1U64">cc</span>+<span class="mxinfo " id="T1:U50"><span class="mxinfo " id="T1:U51">cosd(<span class="mxinfo " id="T1:U52"><span class="mxinfo " id="T1:U53"><span class="mxinfo " id="T1:U54"><span class="var type1" id="S12T1U71">f</span>*<span class="mxinfo " id="T1:U56">360</span></span>*<span class="var type1" id="S18T1U73">i</span></span>/<span class="var type1" id="S7T1U74">Fd</span></span>)</span>^2</span></span></span>;   <span class="comment">% time starts from zero,</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line">    <span class="mxinfo " id="T1:U59"><span class="var type1" id="S15T1U78">ss</span>=<span class="mxinfo " id="T1:U61"><span class="var type1" id="S15T1U80">ss</span>+<span class="mxinfo " id="T1:U63"><span class="mxinfo " id="T1:U64">sind(<span class="mxinfo " id="T1:U65"><span class="mxinfo " id="T1:U66"><span class="mxinfo " id="T1:U67"><span class="var type1" id="S12T1U87">f</span>*<span class="mxinfo " id="T1:U69">360</span></span>*<span class="var type1" id="S18T1U89">i</span></span>/<span class="var type1" id="S7T1U90">Fd</span></span>)</span>^2</span></span></span>;   <span class="comment">% and the index starts from one</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo " id="T1:U72"><span class="var type1" id="S16T1U94">yc</span>=<span class="mxinfo " id="T1:U74"><span class="var type1" id="S16T1U96">yc</span>+<span class="mxinfo " id="T1:U76"><span class="mxinfo " id="T1:U77"><span class="var type1" id="S8T2U99">Signal</span>(<span class="mxinfo " id="T1:U79"><span class="var type1" id="S18T1U101">i</span>+<span class="mxinfo " id="T1:U81">1</span></span>)</span>*<span class="mxinfo " id="T1:U82">cosd(<span class="mxinfo " id="T1:U83"><span class="mxinfo " id="T1:U84"><span class="mxinfo " id="T1:U85"><span class="var type1" id="S12T1U108">f</span>*<span class="mxinfo " id="T1:U87">360</span></span>*<span class="var type1" id="S18T1U110">i</span></span>/<span class="var type1" id="S7T1U111">Fd</span></span>)</span></span></span></span>; <span class="comment">% so in sines and cosines is i</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo " id="T1:U90"><span class="var type1" id="S17T1U114">ys</span>=<span class="mxinfo " id="T1:U92"><span class="var type1" id="S17T1U116">ys</span>+<span class="mxinfo " id="T1:U94"><span class="mxinfo " id="T1:U95"><span class="var type1" id="S8T2U119">Signal</span>(<span class="mxinfo " id="T1:U97"><span class="var type1" id="S18T1U121">i</span>+<span class="mxinfo " id="T1:U99">1</span></span>)</span>*<span class="mxinfo " id="T1:U100">sind(<span class="mxinfo " id="T1:U101"><span class="mxinfo " id="T1:U102"><span class="mxinfo " id="T1:U103"><span class="var type1" id="S12T1U128">f</span>*<span class="mxinfo " id="T1:U105">360</span></span>*<span class="var type1" id="S18T1U130">i</span></span>/<span class="var type1" id="S7T1U131">Fd</span></span>)</span></span></span></span>; <span class="comment">% and the signal contains the index i + 1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line"><span class="keyword">end</span>                             <span class="comment">% end of accumulation of sums for the matrix</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo " id="T5:U108"><span class="var type1" id="S21T5U134">A</span>=<span class="mxinfo " id="T5:U110">[<span class="mxinfo " id="T6:U111"><span class="var type1" id="S14T1U137">cc</span> <span class="var type1" id="S13T1U138">cs</span></span>                        <span class="comment">% solution of a system of linear equations (SLE)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line">   <span class="mxinfo " id="T6:U114"><span class="var type1" id="S13T1U140">cs</span> <span class="var type1" id="S15T1U141">ss</span></span>]</span></span>;                      <span class="comment">% assigning sums to matrix A</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T7:U117"><span class="var type1" id="S22T7U144">B</span>=<span class="mxinfo " id="T7:U119">[<span class="var type1" id="S16T1U147">yc</span>; <span class="var type1" id="S17T1U149">ys</span>;]</span></span>;                    <span class="comment">% assign sums to matrix B</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T7:U122"><span class="var type1" id="S23T7U152">X</span>=<span class="mxinfo " id="T7:U124"><span class="var type1" id="S21T5U154">A</span>\<span class="var type1" id="S22T7U155">B</span></span></span>;                          <span class="comment">% SLE decision vector</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo " id="T1:U127"><span class="var type1" id="S2T1U158">a</span>=<span class="mxinfo " id="T1:U129"><span class="mxinfo " id="T1:U130">sqrt(<span class="mxinfo " id="T1:U131"><span class="mxinfo " id="T1:U132"><span class="mxinfo " id="T1:U133"><span class="var type1" id="S23T7U165">X</span>(<span class="mxinfo " id="T8:U135">1</span>)</span>^2</span>+<span class="mxinfo " id="T1:U136"><span class="mxinfo " id="T1:U137"><span class="var type1" id="S23T7U170">X</span>(<span class="mxinfo " id="T8:U139">2</span>)</span>^2</span></span>)</span>-<span class="mxinfo " id="T1:U140">mean(<span class="var type1" id="S10T4U175">FftS</span>)</span></span></span>; <span class="comment">% subtraction signal amplitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo " id="T1:U142"><span class="var type1" id="S3T1U178">p</span>=<span class="mxinfo " id="T1:U144"><span class="mxinfo " id="T1:U145">180</span>+<span class="mxinfo " id="T1:U146"><span class="mxinfo " id="T1:U147">sign(<span class="mxinfo " id="T1:U148"><span class="var type1" id="S23T7U185">X</span>(<span class="mxinfo " id="T8:U150">1</span>)</span>)</span>*(<span class="mxinfo " id="T1:U151"><span class="mxinfo " id="T1:U152">acosd(<span class="mxinfo " id="T1:U153"><span class="mxinfo " id="T1:U154">sign(<span class="mxinfo " id="T1:U155"><span class="var type1" id="S23T7U195">X</span>(<span class="mxinfo " id="T8:U157">2</span>)</span>)</span>/<span class="mxinfo " id="T1:U158">sqrt(<span class="mxinfo " id="T1:U159"><span class="mxinfo " id="T1:U160">1</span>+<span class="mxinfo " id="T1:U161">(<span class="mxinfo " id="T1:U162"><span class="mxinfo " id="T1:U163"><span class="var type1" id="S23T7U205">X</span>(<span class="mxinfo " id="T8:U165">1</span>)</span>/<span class="mxinfo " id="T1:U166"><span class="var type1" id="S23T7U208">X</span>(<span class="mxinfo " id="T8:U168">2</span>)</span></span>)^2</span></span>)</span></span>)</span>-<span class="mxinfo " id="T1:U169">180</span></span>)</span></span></span>; <span class="comment">% subtraction signal phase 0<span class="keyword">...</span><span class="comment">360</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line"><span class="mxinfo " id="T2:U170"><span class="var type1" id="S4T2U214">RS</span>=<span class="mxinfo " id="T2:U172"><span class="var type1" id="S8T2U216">Signal</span>-<span class="mxinfo " id="T2:U174"><span class="var type1" id="S2T1U218">a</span>*<span class="mxinfo " id="T2:U176">sind(<span class="mxinfo " id="T2:U177"><span class="mxinfo " id="T2:U178">(<span class="mxinfo " id="T1:U179"><span class="var type1" id="S12T1U225">f</span>*<span class="mxinfo " id="T1:U181">360</span></span>).*<span class="var type1" id="S11T2U227">T</span></span>+<span class="var type1" id="S3T1U228">p</span></span>)</span></span></span></span>; <span class="comment">% calculate the difference signal</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="mxinfo " id="T3:U184"><span class="var type1" id="S5T3U231">FftR</span>=<span class="mxinfo " id="T3:U186">abs(<span class="mxinfo " id="T9:U187">fft(<span class="var type1" id="S4T2U236">RS</span>,<span class="var type1" id="S9T1U237">FftL</span>)</span>)</span></span>;         <span class="comment">% difference signal match amplitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T3:U190"><span class="var type1" id="S5T3U240">FftR</span>=<span class="mxinfo " id="T3:U192"><span class="mxinfo " id="T3:U193"><span class="mxinfo " id="T1:U194">2</span>*<span class="var type1" id="S5T3U244">FftR</span></span>./<span class="var type1" id="S9T1U245">FftL</span></span></span>;              <span class="comment">% Spectrum normalization by amplitude</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"></span></span>
</pre>
</body>
</html>
